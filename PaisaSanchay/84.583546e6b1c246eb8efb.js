(self.webpackChunkpaisa_sanchay=self.webpackChunkpaisa_sanchay||[]).push([[84],{2084:(e,t,i)=>{"use strict";i.r(t),i.d(t,{ReportModule:()=>I});var n=i(1116),o=i(3337),r=i(5366),l=i(1458),a=i(9199),c=i(1041),s=i(5204),u=i(529),m=i(1039);let p=(()=>{class e{constructor(e){this.http=e}getreport(e){return this.http.httpGet(`${u.N.api}collectionReports/all?`,e)}downloadReport(e){return this.http.httpGet(`${u.N.api}collectionReports/download?`,e)}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(m.m))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var d=i(3070),h=i(9550),f=i(9024),Z=i(3841),g=i(7064),v=i(4155),A=i(4369);function b(e,t){if(1&e&&(r.TgZ(0,"mat-option",37),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e.id),r.xp6(1),r.hij(" ",e.name," ")}}function w(e,t){if(1&e&&(r.TgZ(0,"mat-option",37),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e.id),r.xp6(1),r.hij(" ",e.username," ")}}function q(e,t){if(1&e&&(r.TgZ(0,"div",38),r.TgZ(1,"div",39),r.TgZ(2,"div",1),r.TgZ(3,"div",40),r.TgZ(4,"div",41),r.TgZ(5,"div",1),r.TgZ(6,"div",42),r.TgZ(7,"b"),r._uU(8),r.qZA(),r.qZA(),r.TgZ(9,"div",42),r.TgZ(10,"b"),r._uU(11),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA()),2&e){const e=r.oxw();r.xp6(8),r.hij("Debit: ",e.total.debit,""),r.xp6(3),r.hij("Credit: ",e.total.credit,"")}}function T(e,t){1&e&&(r.TgZ(0,"mat-header-cell"),r._uU(1," Voucher Number "),r.qZA())}function _(e,t){if(1&e&&(r.TgZ(0,"mat-cell"),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.xp6(1),r.hij(" ",null==e?null:e.voucher_number," ")}}function S(e,t){1&e&&(r.TgZ(0,"mat-header-cell"),r._uU(1," Member Card Number "),r.qZA())}function D(e,t){if(1&e&&(r.TgZ(0,"mat-cell"),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.xp6(1),r.hij(" ",null==e?null:e.cardnumber," ")}}function x(e,t){1&e&&(r.TgZ(0,"mat-header-cell",43),r._uU(1," Member Name "),r.qZA())}function y(e,t){if(1&e&&(r.TgZ(0,"mat-cell",43),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.xp6(1),r.hij(" ",null==e?null:e.member," ")}}function N(e,t){1&e&&(r.TgZ(0,"mat-header-cell"),r._uU(1," User Name "),r.qZA())}function U(e,t){if(1&e&&(r.TgZ(0,"mat-cell"),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.xp6(1),r.hij(" ",null==e?null:e.user," ")}}function C(e,t){1&e&&(r.TgZ(0,"mat-header-cell"),r._uU(1," Amount "),r.qZA())}function k(e,t){if(1&e&&(r.TgZ(0,"mat-cell"),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.xp6(1),r.hij(" ",null==e?null:e.amount," ")}}function Y(e,t){1&e&&(r.TgZ(0,"mat-header-cell"),r._uU(1," Date "),r.qZA())}function O(e,t){if(1&e&&(r.TgZ(0,"mat-cell"),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.xp6(1),r.hij(" ",null==e?null:e.transactiondate," ")}}function F(e,t){1&e&&(r.TgZ(0,"mat-header-cell"),r._uU(1," Operation "),r.qZA())}function M(e,t){if(1&e&&(r.TgZ(0,"mat-cell"),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.xp6(1),r.hij(" ",null==e?null:e.operation," ")}}function Q(e,t){1&e&&(r.TgZ(0,"mat-header-cell"),r._uU(1," Collection Mode "),r.qZA())}function J(e,t){if(1&e&&(r.TgZ(0,"mat-cell"),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.xp6(1),r.hij(" ",null==e?null:e.collectionmode," ")}}function R(e,t){1&e&&r._UZ(0,"mat-header-row")}function j(e,t){1&e&&r._UZ(0,"mat-row")}let B=(()=>{class e{constructor(e,t,i,n){this.fb=e,this.homeService=t,this.spinnerService=i,this.reportService=n,this.displayedColumns=["Voucher_number","date","member_card_number","member_name","user_name","amount","operation","collectionMode"],this.dataSource=new a.by([]),this.now=new Date,this.operation=[{id:"All",name:"All"},{id:"Receipt",name:"Receipt"},{id:"Payment",name:"Payment"},{id:"Opening balance",name:"Opening balance"}],this.collectionMode=[{id:"All",name:"All"},{id:"loan",name:"Loan"},{id:"mdtwf",name:"MDTWF"},{id:"subscription",name:"Subscription"},{id:"kuri",name:"Kuri"}],this.filterOptions={operation:[...this.operation],collectionMode:[...this.collectionMode],userid:[]},this.selectOptions={operation:[...this.operation],collectionMode:[...this.collectionMode],userid:[]},this.oldSelects={},this.searchKeyMapping={operation:"name",collectionMode:"name",userid:"username"}}ngOnInit(){this.getUsers(),this.filterForm=this.createFilterForm();for(let e in this.filterForm.controls)-1!=e.indexOf("Search")&&this.filterForm.controls[e].valueChanges.subscribe(t=>{this.filter(e,t)})}getUsers(){this.spinnerService.showSpinner(),this.homeService.getUsers().subscribe(e=>{e.users.unshift({id:"All",username:"All"}),this.filterOptions.userid=e.users,this.selectOptions.userid=e.users,this.spinnerService.hideSpinner()},e=>{this.filterOptions.userid=[],this.selectOptions.userid=[],this.spinnerService.hideSpinner()})}createFilterForm(){return this.fb.group({fromDate:[new Date],toDate:[new Date],operation:[],collectionMode:[],userid:[],useridSearch:[""]})}filter(e,t){var i;null!=t&&(this.filterOptions[e.split("Search")[0]]=null===(i=this.selectOptions[e.split("Search")[0]])||void 0===i?void 0:i.filter(i=>{var n;return null===(n=i[this.searchKeyMapping[e.split("Search")[0]]])||void 0===n?void 0:n.toLowerCase().includes(t.toLowerCase())}))}runReport(){this.spinnerService.showSpinner(),this.reportService.getreport(this.payload()).subscribe(e=>{var t;this.dataSource=new a.by(null===(t=null==e?void 0:e.result)||void 0===t?void 0:t.results.map(e=>(e.transactiondate=e.transactiondate.substring(8,10)+"-"+e.transactiondate.substring(5,7)+"-"+e.transactiondate.substring(0,4),e))),this.total=e.result.totalBalance,this.spinnerService.hideSpinner()},e=>{this.dataSource=new a.by([]),this.spinnerService.hideSpinner()})}downloadReport(){this.spinnerService.showSpinner(),this.reportService.downloadReport(this.payload()).subscribe(e=>{console.log(e),this.spinnerService.hideSpinner()},e=>{console.log(e),this.spinnerService.hideSpinner()})}payload(){let e={};const t=Object.assign(Object.assign({},this.filterForm.value),{fromDate:this.formatDate(this.filterForm.value.fromDate),toDate:this.formatDate(this.filterForm.value.toDate)});for(var i of(delete t.transactionSearch,delete t.collectionSearch,delete t.useridSearch,Object.keys(t)))null!=t[i]&&(e[i]=t[i]);return e}resetFilter(){this.filterForm.reset(),this.filterForm.controls.fromDate.setValue(new Date),this.filterForm.controls.toDate.setValue(new Date),this.filterForm.updateValueAndValidity(),this.runReport()}formatDate(e){let t=new Date(e),i=""+(t.getMonth()+1),n=""+t.getDate(),o=t.getFullYear();return i.length<2&&(i="0"+i),n.length<2&&(n="0"+n),[o,i,n].join("-")}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(c.qu),r.Y36(l.Y),r.Y36(s.V),r.Y36(p))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-report-view"]],decls:66,vars:13,consts:[[1,"card-container",3,"formGroup"],[1,"row"],[1,"col-6","col-lg-2","col-lg-2"],[1,"input-field","w-100"],["matInput","","placeholder","start date","formControlName","fromDate",3,"matDatepicker"],["matSuffix","",3,"for"],["picker1",""],[1,"col-6","col-lg-2"],["matInput","","placeholder","end Date","formControlName","toDate",3,"matDatepicker"],["picker2",""],[1,"mt-2","mt-lg-0","w-100"],["formControlName","operation","placeholder","Select operation type",3,"multiple"],["transactionType",""],[3,"value",4,"ngFor","ngForOf"],["formControlName","userid","placeholder","Select user",3,"multiple"],["usercntrl",""],["formControlName","useridSearch","placeholderLabel","search payment option","noEntriesFoundLabel","No search result found"],["mat-raised-button","","color","primary",1,"close","mt-2","mt-lg-0",3,"click"],[1,"row","justify-content-end"],["class","col-12 col-lg-4",4,"ngIf"],[1,"card-container","mt-4"],[1,"row","report"],[1,"mat-elevation-z8","report",3,"dataSource"],["matColumnDef","Voucher_number"],[4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","member_card_number"],["matColumnDef","member_name"],["class","w-10",4,"matHeaderCellDef"],["class","w-10",4,"matCellDef"],["matColumnDef","user_name"],["matColumnDef","amount"],["matColumnDef","date",1,"text-center"],["matColumnDef","operation"],["matColumnDef","collectionMode"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],[3,"value"],[1,"col-12","col-lg-4"],[1,"container","mt-2","mt-lg-0"],[1,"card","py-1"],[1,"card-body","p-1","text-center"],[1,"col-6"],[1,"w-10"]],template:function(e,t){if(1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"div",1),r.TgZ(2,"div",2),r.TgZ(3,"mat-form-field",3),r._UZ(4,"input",4),r._UZ(5,"mat-datepicker-toggle",5),r._UZ(6,"mat-datepicker",null,6),r.qZA(),r.qZA(),r.TgZ(8,"div",7),r.TgZ(9,"mat-form-field",3),r._UZ(10,"input",8),r._UZ(11,"mat-datepicker-toggle",5),r._UZ(12,"mat-datepicker",null,9),r.qZA(),r.qZA(),r.TgZ(14,"div",7),r.TgZ(15,"mat-form-field",10),r.TgZ(16,"mat-select",11,12),r.YNc(18,b,2,2,"mat-option",13),r.qZA(),r.qZA(),r.qZA(),r.TgZ(19,"div",7),r.TgZ(20,"mat-form-field",10),r.TgZ(21,"mat-select",14,15),r.TgZ(23,"mat-option"),r._UZ(24,"ngx-mat-select-search",16),r.qZA(),r.YNc(25,w,2,2,"mat-option",13),r.qZA(),r.qZA(),r.qZA(),r.TgZ(26,"div",7),r.TgZ(27,"button",17),r.NdJ("click",function(){return t.resetFilter()}),r._uU(28,"Reset Filter"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(29,"div",18),r.YNc(30,q,12,2,"div",19),r.TgZ(31,"div",7),r.TgZ(32,"button",17),r.NdJ("click",function(){return t.runReport()}),r._uU(33,"Run Report"),r.qZA(),r.qZA(),r.TgZ(34,"div",7),r.TgZ(35,"button",17),r.NdJ("click",function(){return t.downloadReport()}),r._uU(36,"Dowload Report"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.TgZ(37,"div",20),r.TgZ(38,"div",21),r.TgZ(39,"mat-table",22),r.ynx(40,23),r.YNc(41,T,2,0,"mat-header-cell",24),r.YNc(42,_,2,1,"mat-cell",25),r.BQk(),r.ynx(43,26),r.YNc(44,S,2,0,"mat-header-cell",24),r.YNc(45,D,2,1,"mat-cell",25),r.BQk(),r.ynx(46,27),r.YNc(47,x,2,0,"mat-header-cell",28),r.YNc(48,y,2,1,"mat-cell",29),r.BQk(),r.ynx(49,30),r.YNc(50,N,2,0,"mat-header-cell",24),r.YNc(51,U,2,1,"mat-cell",25),r.BQk(),r.ynx(52,31),r.YNc(53,C,2,0,"mat-header-cell",24),r.YNc(54,k,2,1,"mat-cell",25),r.BQk(),r.ynx(55,32),r.YNc(56,Y,2,0,"mat-header-cell",24),r.YNc(57,O,2,1,"mat-cell",25),r.BQk(),r.ynx(58,33),r.YNc(59,F,2,0,"mat-header-cell",24),r.YNc(60,M,2,1,"mat-cell",25),r.BQk(),r.ynx(61,34),r.YNc(62,Q,2,0,"mat-header-cell",24),r.YNc(63,J,2,1,"mat-cell",25),r.BQk(),r.YNc(64,R,1,0,"mat-header-row",35),r.YNc(65,j,1,0,"mat-row",36),r.qZA(),r.qZA(),r.qZA()),2&e){const e=r.MAs(7),i=r.MAs(13);r.Q6J("formGroup",t.filterForm),r.xp6(4),r.Q6J("matDatepicker",e),r.xp6(1),r.Q6J("for",e),r.xp6(5),r.Q6J("matDatepicker",i),r.xp6(1),r.Q6J("for",i),r.xp6(5),r.Q6J("multiple",!1),r.xp6(2),r.Q6J("ngForOf",t.filterOptions.operation),r.xp6(3),r.Q6J("multiple",!1),r.xp6(4),r.Q6J("ngForOf",t.filterOptions.userid),r.xp6(5),r.Q6J("ngIf",t.dataSource.data.length),r.xp6(9),r.Q6J("dataSource",t.dataSource),r.xp6(25),r.Q6J("matHeaderRowDef",t.displayedColumns),r.xp6(1),r.Q6J("matRowDefColumns",t.displayedColumns)}},directives:[c.JL,c.sg,d.KE,h.Nt,c.Fj,f.hl,c.JJ,c.u,f.nW,d.R9,f.Mq,Z.gD,n.sg,g.ey,v.nu,A.lW,n.O5,a.BZ,a.w1,a.fO,a.Dz,a.as,a.nj,a.ge,a.ev,a.XQ,a.Gk],styles:[".close[_ngcontent-%COMP%]{position:sticky!important;width:100%;bottom:0;color:#fff;font-size:14px;font-weight:600px}.table[_ngcontent-%COMP%]{width:100%;overflow:scroll}.w-10[_ngcontent-%COMP%]{width:100px}.float[_ngcontent-%COMP%]{float:right}"]}),e})();const $=[{path:"",component:(()=>{class e{constructor(e,t){this.homeService=e,this.route=t,t.data.subscribe(t=>{e.headerSubject$.next(t.header)})}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(l.Y),r.Y36(o.gz))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-report"]],decls:4,vars:0,consts:[[1,"container"],[1,"row"],[1,"col-12"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"div",1),r.TgZ(2,"div",2),r._UZ(3,"app-report-view"),r.qZA(),r.qZA(),r.qZA())},directives:[B],styles:[""]}),e})(),data:{header:"Report"}}];let z=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[o.Bz.forChild($)],o.Bz]}),e})();var V=i(1986);let I=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[n.ez,z,V.m]]}),e})()}}]);